@page "/Upload"
@using MLocker.WebApp.Services
@inject IMusicService MusicService
<h1>Upload</h1>

<p>Add files to your library:</p>

<p>
    <InputFile OnChange="@OnInputFileChange" webkitdirectory directory multiple accept="audio/*" />
</p>

<p>@_uploadMessage</p>

@code {
    string _uploadMessage;

    private async Task OnInputFileChange(InputFileChangeEventArgs e)
    {
        var files = e.GetMultipleFiles(1000000);
        foreach (var file in files)
        {
           // if (file.ContentType == "audio/mpeg" || file.ContentType == "audio/mp4")
            {
                _uploadMessage = $"Uploading {file.Name}";
                await MusicService.Upload(file.Name, file.OpenReadStream(100000000));
            }
        }
    }

}